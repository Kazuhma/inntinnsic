<?xml version="1.0" encoding="UTF-8" ?>
<ContentPage
    x:Class="Inntinnsic.Views.ResultsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:views="clr-namespace:Inntinnsic.Views"
    Title="Scan Results"
    BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLight}, Dark={StaticResource BackgroundDark}}">

    <ContentPage.Content>
        <Grid ColumnDefinitions="*, *" ColumnSpacing="20" Padding="20">

            <!-- Left Column: Results List -->
            <ScrollView x:Name="ResultsScrollView" Grid.Column="0">
                <VerticalStackLayout Spacing="15">
                    <!-- Results Summary -->
                    <Border BackgroundColor="{AppThemeBinding Light={StaticResource CardLight}, Dark={StaticResource CardDark}}"
                            Padding="15"
                            StrokeThickness="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12"/>
                        </Border.StrokeShape>

                        <Label x:Name="SummaryLabel"
                               Text="Found 0 flagged images"
                               FontSize="14"
                               FontAttributes="Bold"/>
                    </Border>

                    <!-- Results List -->
                    <VerticalStackLayout x:Name="ResultsListStack" Spacing="10"/>

                </VerticalStackLayout>
            </ScrollView>

            <!-- Right Column: Image Preview -->
            <Border Grid.Column="1"
                    BackgroundColor="#1E293B"
                    Stroke="#334155"
                    StrokeThickness="1"
                    Padding="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12"/>
                </Border.StrokeShape>

                <Grid RowDefinitions="Auto, *">
                    <!-- Preview Header with Filename and Buttons -->
                    <Grid Grid.Row="0"
                          Padding="15"
                          BackgroundColor="#1E293B"
                          ColumnDefinitions="*, Auto">
                        <Label x:Name="PreviewFilenameLabel"
                               Grid.Column="0"
                               Text="Select an image to preview"
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="White"
                               VerticalOptions="Center"
                               LineBreakMode="MiddleTruncation"/>

                        <!-- Action Buttons -->
                        <HorizontalStackLayout Grid.Column="1" Spacing="8">
                            <Button x:Name="PreviewOpenFolderButton"
                                    Text="ðŸ“‚"
                                    FontSize="16"
                                    BackgroundColor="Transparent"
                                    TextColor="#3B82F6"
                                    WidthRequest="48"
                                    HeightRequest="36"
                                    CornerRadius="6"
                                    IsVisible="False"
                                    ToolTipProperties.Text="Open folder"
                                    Clicked="OnPreviewOpenFolderClicked"/>
                            <Button x:Name="PreviewDeleteButton"
                                    Text="ðŸ—‘ï¸"
                                    FontSize="16"
                                    BackgroundColor="Transparent"
                                    TextColor="#EF4444"
                                    WidthRequest="48"
                                    HeightRequest="36"
                                    CornerRadius="6"
                                    IsVisible="False"
                                    ToolTipProperties.Text="Delete file"
                                    Clicked="OnPreviewDeleteClicked"/>
                            <Button x:Name="PreviewIgnoreButton"
                                    Text="âœ•"
                                    FontSize="16"
                                    BackgroundColor="Transparent"
                                    TextColor="#9CA3AF"
                                    WidthRequest="48"
                                    HeightRequest="36"
                                    CornerRadius="6"
                                    IsVisible="False"
                                    ToolTipProperties.Text="Ignore result"
                                    Clicked="OnPreviewIgnoreClicked"/>
                        </HorizontalStackLayout>
                    </Grid>

                    <!-- Image Preview Area -->
                    <Grid Grid.Row="1" BackgroundColor="#0F172A">
                        <views:DetectionImageView x:Name="PreviewImage"
                                                   HorizontalOptions="Fill"
                                                   VerticalOptions="Fill"/>

                        <!-- Placeholder when no image selected -->
                        <Label x:Name="PreviewPlaceholderLabel"
                               Text="Select an image from the list to preview"
                               TextColor="#64748B"
                               FontSize="16"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"
                               IsVisible="True"/>
                    </Grid>
                </Grid>
            </Border>

        </Grid>
    </ContentPage.Content>
</ContentPage>
